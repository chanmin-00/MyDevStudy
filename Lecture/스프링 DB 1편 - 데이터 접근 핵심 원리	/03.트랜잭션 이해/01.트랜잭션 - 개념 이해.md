# 왜 데이터베이스를 사용하는가?

단순한 데이터 저장만 생각한다면 파일 시스템을 사용해도 된다. 하지만 데이터베이스를 사용하는 가장 큰 이유 중 하나는 `트랜잭션(Transaction)` 기능 때문이다.

> 트랜잭션은 하나의 작업 단위(거래)를 안전하게 처리하도록 보장해주는 기능이다.
> 

A가 B에게 5000원을 송금한다고 가정해보자.

1. A의 잔고에서 5000원을 차감
2. B의 잔고에 5000원을 추가

이 두 작업은 반드시 함께 성공하거나, 함께 실패해야 한다. 하나만 처리되고 중간에 시스템 문제가 생기면 데이터 불일치(예: A만 돈이 빠지고 B는 안 들어옴)가 발생한다.

트랜잭션을 사용하면 두 작업을 하나의 묶음으로 처리할 수 있다. 중간에 예외가 발생하면, 전체 작업을 취소하고 원래 상태로 되돌릴 수 있다.

| 용어 | 설명 |
| --- | --- |
| `Commit` | 모든 작업이 성공 → DB에 최종 반영 |
| `Rollback` | 중간에 실패 → 전체 작업을 취소하고 이전 상태로 되돌림 |

# 트랜잭션의 4대 속성 : ACID

> 데이터베이스 트랜잭션은 ACID 원칙을 따라야 한다.
> 

| 속성 | 설명 |
| --- | --- |
| `Atomicity (원자성)` | 트랜잭션 내 모든 작업이 전부 성공하거나, 전부 실패해야 한다. 중간 실패는 허용되지 않음. |
| `Consistency (일관성)` | 트랜잭션 수행 전과 후에 데이터는 항상 정해진 규칙(무결성)을 만족해야 한다. |
| `Isolation (격리성)` | 동시에 실행되는 트랜잭션들이 서로 영향을 주지 않아야 한다. |
| `Durability (지속성)`  | 트랜잭션이 성공적으로 커밋되면, 시스템 오류가 나더라도 결과는 유지되어야 한다. |

# 격리성(Isolation)의 어려움

격리성을 완벽히 보장하려면 트랜잭션을 순차적으로 처리해야 한다. 이렇게 하면 성능이 급격히 나빠진다.

- 그래서 ANSI SQL 표준에서는 `격리 수준(Isolation Level)`을 4단계로 나누어 정의했다.

## 트랜잭션 격리 수준 (Isolation Level)

트랜잭션의 동시 처리 성능과 데이터 정합성 사이에서 절충이 필요하다.

아래는 격리 수준별 특징

| 격리 수준 | 설명 |
| --- | --- |
| `READ UNCOMMITTED`  | 다른 트랜잭션이 아직 커밋하지 않은 데이터도 읽을 수 있음 (Dirty Read 허용) |
| `READ COMMITTED` | 커밋된 데이터만 읽을 수 있음, 기본적으로 많이 사용됨 (Dirty Read 방지) |
| `REPEATABLE READ`  | 트랜잭션 내에서 같은 쿼리를 반복해도 결과가 같음 (Phantom Read는 발생 가능) |
| `SERIALIZABLE`  | 가장 강력한 격리 수준. 트랜잭션을 직렬화하여 순차적 실행 (성능 저하) |

> 실무에서는 READ COMMITTED가 대부분의 DBMS(MySQL, Oracle 등)에서 기본 설정으로 사용된다.
>
