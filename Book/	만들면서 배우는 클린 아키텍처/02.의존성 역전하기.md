# 단일 책임 원칙 (SRP)



단일 책임 원칙은 흔히 `하나의 컴포넌트는 오로지 한 가지 일만 해야 한다` 로 해석되지만, 실제 의도는 다음과 같다:

> 컴포넌트를 변경하는 이유는 오직 하나뿐이어야 한다.
> 

즉, '책임'은 `한 가지 일`이 아니라 `변경의 이유` 로 해석해야 한다.

이 원칙을 잘 지키면, 어떤 변경이 일어나더라도 관련 없는 컴포넌트는 영향을 받지 않기 때문에 시스템은 안정적으로 유지된다.

그러나 의존성은 이러한 원칙을 위반하게 만든다.

<img width="293" alt="image" src="https://github.com/user-attachments/assets/c93e1545-7cca-4a2a-8102-2594048e1ef0" />


그림에서처럼 의존성이 많을수록, 다른 컴포넌트의 변경에 따라 자신도 변경될 가능성이 커지기 때문이다.

결국 변경 이유가 복잡해지고, 유지보수는 점점 어려워진다.

# 부수효과에 관한 이야기


저자는 10년 된 레거시 코드를 다룬 경험을 통해, 단 하나의 변경이 다른 곳에서 예기치 않은 부작용을 일으키는 상황을 소개한다.

심지어 클라이언트조차도 특정 컴포넌트의 변경을 꺼려 이상하고 비효율적인 구현을 선택했다.

이는 구조화되지 않은 시스템에서 변경 비용이 급격히 증가한다는 현실을 보여준다.

# 의존성 역전 원칙 (DIP)


계층형 아키텍처에서는 상위 계층이 항상 하위 계층에 의존한다.

하지만 도메인 로직은 애플리케이션에서 가장 중요하기 때문에, 덜 중요한 하위 계층(예: DB 관련 코드)의 변경에 영향을 받아서는 안 된다.

이를 해결하는 방법이 바로 `의존성 역전 원칙`이다.

> 코드 상의 어떤 의존성도 그 방향을 역전시킬 수 있다.
> 

예를 들어 도메인 계층이 영속성 계층의 엔티티나 리포지토리에 의존한다면, 도메인 계층에 **인터페이스**를 두고 실제 구현은 영속성 계층에서 하게 만들어 의존성 방향을 반대로 만든다.

<img width="488" alt="image" src="https://github.com/user-attachments/assets/8ff9121c-af72-46d7-af1b-38527a1897da" />


그림은 이를 통해 도메인 계층이 더 이상 하위 계층에 의존하지 않도록 구성된 구조를 보여준다.

# 클린 아키텍처



로버트 C. 마틴은 클린 아키텍처에서 다음과 같은 원칙을 제시했다:

> **비즈니스 규칙은 테스트하기 쉬워야 하며, 프레임워크, 데이터베이스, UI 등 외부 기술로부터 독립적이어야 한다.**
> 

> 모든 의존성은 도메인 로직을 향해 안쪽 방향으로 향해야 한다.
> 

<img width="393" alt="image" src="https://github.com/user-attachments/assets/86e80196-6fc0-4e84-bdab-e783ffc15f61" />


그림은 클린 아키텍처의 계층 구조를 보여준다.

중심에는 도메인 엔티티와 유스케이스가 위치하며, 바깥쪽에는 UI, 데이터베이스, 외부 시스템과 같은 요소들이 있다.

**중심을 향한 방향성 덕분에 도메인 로직은 외부의 영향을 받지 않고 독립적으로 모델링될 수 있다.**

하지만 이 구조에는 **비용**이 따른다.

도메인과 영속성 계층이 분리되어 있으므로 같은 데이터를 사용하더라도 각 계층에서 모델을 따로 정의하고 변환해야 한다.

예를 들어 ORM을 사용할 경우, 도메인 계층의 엔티티는 영속성 계층에서 그대로 사용할 수 없기 때문에 변환 로직이 필요하다.

그러나 이러한 번거로움은 도메인 코드를 외부 기술로부터 자유롭게 만들기 위한 비용이며, 바람직한 일이다.

특정 프레임워크의 제약(예: JPA의 기본 생성자 요구사항)으로부터 도메인 로직을 보호할 수 있다

# 육각형 아키텍처(헥사고날 아키텍처)



`육각형 아키텍처`는 알리스테어 코박이 제안한 개념으로, 클린 아키텍처와 유사한 원칙을 따른다.

<img width="552" alt="image" src="https://github.com/user-attachments/assets/8a4e905f-7bec-4637-bb89-f77c1f7ed314" />


이 구조는 `포트와 어댑터` 아키텍처라고도 불린다.

중심에는 도메인 엔티티와 유스케이스가 있고, 외부에는 다양한 어댑터(웹, DB, 외부 시스템 등)가 있다.

- 왼쪽의 어댑터는 애플리케이션을 호출하는 쪽(주도하는 어댑터)
- 오른쪽의 어댑터는 애플리케이션 내부에서 호출되는 쪽(주도되는 어댑터)

각 어댑터는 포트(인터페이스)를 통해 코어와 통신하며, 의존성은 모두 안쪽(코어)을 향한다.

이를 통해 도메인 로직은 외부와 완전히 분리되며, 외부와의 통신은 어댑터가 담당하게 된다.

육각형 아키텍처도 계층 구조를 갖는다:

- 가장 안쪽: 도메인 엔티티
- 중간: 유스케이스와 포트
- 가장 바깥쪽: 어댑터 (웹, DB 등

# 결론



클린 아키텍처, 육각형 아키텍처, 포트와 어댑터 아키텍처는 모두 도메인 코드가 외부 기술에 의존하지 않도록 만들어, **변경 이유의 수를 줄이고 유지보수성을 향상**시킨다.

이 구조 덕분에 도메인 코드는 비즈니스 문제에 맞게 자유롭게 설계할 수 있고, UI나 DB 관련 코드도 각자의 역할에 충실하게 개발할 수 있다.
