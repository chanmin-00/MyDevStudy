# AWS의 사용법과 계정: AWS에서 제공하는 유용한 도구

## AWS를 사용하기 위해 알아야 할 기본 개념

- 클라우드 서비스이므로사용한 만큼 비용을 지불한다가 기본
- 필요한 것을 필요한 만큼만 사용한다는 의미이며, 항상 자신에게 최적화된 상태로 관리한다는 것이 클라우드를 잘 사용하는 요령

<img width="581" alt="image" src="https://github.com/user-attachments/assets/9bcda513-9dde-4cb2-bf9d-8a4d5a6a7a06" />


## AWS는 서비스를 종합적으로 관리할 수 있다

- AWS는 서비스를 종합적으로 관리할 수 있는 편리한 기능을 제공
- 전문가가 없어도 운영할 수 있도록 웹 브라우저로 조작할 수 있는 사용자 환경을 제공하며, `관리 콘솔`, `CLI`, `IAM`, `비용 관리`, `CloudWatch` 등을 통해 서비스 관리 기능을 제공

## AWS 계정

- AWS 계정은 구글 계정이나 애플 ID처럼 개인이나 기업이 생성하여 사용
- EC2(서버), S3(스토리지) 등의 서비스를 임대할 수 있으며, 기업의 경우 프로젝트 단위로 계정을 분리해 사용하는 것이 관리와 비용 측면에서 유리

## Root 사용자

- AWS 계정 생성 시 함께 생성되는 최고 관리자(root) 사용자는 모든 권한을 가지며, 실수 시 치명적
- 따라서 일반적인 사용은 `IAM` 사용자를 통해 제한된 권한만 부여해 운영하는 것이 안전

# 관리 콘솔과 대시보드: 심플하고 직관적인 관리 도구

## 관리 콘솔

- 웹 브라우저에서 AWS 리소스를 직관적으로 관리할 수 있는 환경을 제공
- 각 서비스마다 전용 대시보드가 있으며, 대부분 한국어도 지원된다.
- 모바일에서는 Amazon Console 앱을 통해서도 관리 가능

<img width="534" alt="image" src="https://github.com/user-attachments/assets/997577d0-e6d0-4ea1-8450-e083ac032004" />


## 리전 선택

- AWS는 서비스를 리전(지역) 단위로 나눠 운영
- 같은 EC2라도 리전이 다르면 서로 다른 인스턴스로 간주
- 서비스 제공 여부는 리전에 따라 다르며, 사용 불가 시 경고 메시지가 표시된다.

## 대시보드

- 각 서비스의 설정과 상태를 조작할 수 있는 메인 화면
    - 예: EC2 대시보드, S3 대시보드
- 서비스 시작·종료, 설정 변경, 상태 확인 등을 수행할 수 있으며, 한국어 지원도 가능

<img width="642" alt="image" src="https://github.com/user-attachments/assets/8c6788c2-e6f6-496c-bf11-e8a19df7e0c2" />


## cf) AWS CLI(Common Line Interface)

- 로컬이나 서버에서 명령어 또는 스크립트로 AWS 서비스를 제어할 수 있는 환경
- `aws configure`로 인증정보를 입력하고, `aws` 로 시작하는 등의 명령으로 자원을 조작할 수 있음
- 자동화와 대량 작업에 유용

# AWS IAM과 접근 권한: 접근 권한 설정

## AWS IAM

- `Identity and Access Management(ID와 접속 관리)`의 약어
- IAM은 접근 권한과 인증을 관리하는 서비스로, 사용자나 프로그램(역할)에게 필요한 권한만 부여
    - 사람에 대해 부여하는 IAM을 `IAM 사용자`
    - 서비스나 프로그램 등에 부여하는 IAM은 `IAM 역할`
- IAM 자체는 무료이며, IAM 사용자가 사용하는 리소스에 대해서만 과금
    - AWS는 `MFA(Multi-Factor Authentication,다중 인증)` 사용을 권장

## IAM 그룹과 IAM 정책

- IAM 사용자, IAM 역할 두 가지 모두에 필요한 최소한의 기능을 부여하고, 필요한 사람에게만 전달하여 운영하는 것이 기본
    - 불필요한 권한을 부여하는 것은 보안적으로 바람직하지 않음
    - 계정 하나를 돌려쓰는 것도 바람직하지 않음, 누가 수행한 작업인지 알 수 없기 때문
- 사용자마다 권한을 직접 부여하는 대신, `IAM 그룹`을 만들어 권한을 일괄 적용
- `정책(Policy)`을 통해 누가 어떤 서비스에 어떤 작업을 할 수 있는지 정의하며, 정책을 수정하면 적용된 사용자 전체의 권한이 함께 바뀐다.

<img width="648" alt="image" src="https://github.com/user-attachments/assets/33eaaa4c-5f8e-40be-b314-bf311703b1e2" />


## IAM 정책 설정하기

- 무엇에 대해서 어떤 조작을 허가할지 말지를 설정하는 것
- IAM 정책은 다음을 정의한다
    - `자격 기반 정책`: 누가 무엇을 할 수 있는가
    - `리소스 기반 정책`: 무엇에 대해 어떤 권한을 줄 것인가
    - 예: S3 버킷의 읽기/쓰기/삭제 권한 설정, 특정 IP만 허용 등

- IAM 정책은 자기만의 정책을 생성하는 것이 가능(고객 관리형 정책)핟. 그러나 설정하다 실수할 수 도 있기 때문에 기본적으로 미리 준비되어 있는 AWS 관리 정책을 사용하는 것을 추천
    - `AWS 관리형 정책`을 사용하되, 필요한 경우 `고객 관리형 정책`을 추가로 만든다.
- 정책 구성 요소는 다음과 같다


    | 항목 | 설명 |
    | --- | --- |
    | `Sid` | Statement를 식별하기 위한 고유 ID (선택 항목) |
    | `Effect` | 정책의 효과를 지정. Allow(허용) 또는 Deny(거부) 중 하나 |
    | `Action` | 허용하거나 거부할 AWS 서비스의 작업(동작) 예: s3:PutObject, ec2:StartInstances |
    | `NotAction` | 명시된 작업을 제외한 모든 작업을 대상으로 지정 |
    | `Resource` | 정책이 적용되는 대상 자원 (예: 특정 S3 버킷, EC2 인스턴스 ARN 등) |
    | `NotResource` | 명시된 자원을 제외한 모든 자원을 대상으로 지정 |
    | `Condition` | 정책의 실행 여부를 제어하는 조건식. IP 주소, 시간대, MFA 사용 여부 등으로 제한 |

## cf) 다단계, 다요소 인증

- IAM에서는 다단계 인증과 다요소 인증을 사용할 수 있다.
- `다단계 인증`: ID와 비밀번호 외에 추가 인증 절차를 거치는 방식
- `다요소 인증(MFA)`: 서로 다른 유형의 인증 수단을 사용하는 방식 (예: 비밀번호 + 앱)
    - AWS에서는 스마트폰 앱(MFA 앱)이나 하드웨어 토큰을 사용해 일회용 코드(OTP)를 입력하는 방식으로 MFA를 지원

<img width="587" alt="image" src="https://github.com/user-attachments/assets/32f1187b-8c96-4bed-b91e-8398f81eae65" />


# Amazon CloudWatch: Amazon EC2의 리소스 상태 감시

## Amazon CloudWatch

- AWS 리소스의 지표와 로그를 수집, 감시하는 서비스
- CPU 사용률, 네트워크 트래픽 등 주요 자원을 모니터링하고, 임계치를 초과하면 자동으로 알림을 보내거나 조치를 취할 수 있음
- CloudWatch는 기본 요금은 없고, 사용한 만큼만 과금
- Amazon cloudWatch 는 지원하는 서비스와 지원하지 않는 서비스가 있음

## 사용 가능한 조작과 Amazon CloudWatch Logs

- CloudWatch는 다음 작업을 자동으로 수행할 수 있다:
    - 이메일 알림 전송
    - EC2 인스턴스 시작/정지
    - Auto Scaling
    - Lambda 함수에 의한 임의 프로그램 실행 등
- CloudWatch Logs를 이용하면 로그를 수집 및 저장하고, 필요 시 S3로 내보내거나 삭제할 수 있음
- 또한, `AWS CloudTrail`을 연동해 누가 어떤 리소스에 접근했는지도 기록으로 남길 수 있음

# AWS Billing and Cost Management: AWS 의 비용 관리

## AWS Billing and Cost Management

- AWS는 종량제 요금제이기 때문에 요금 관리가 매우 중요하다.
- 지출 추적, 예산 설정, 상세 리포트, 서비스 해지 등을 제공하는 기능이 있음

## 비용을 확인할 수 있다

- `Cost Explorer`: 서비스 단위별로 일별/월별 사용량과 비용을 그래프로 확인

<img width="630" alt="image" src="https://github.com/user-attachments/assets/b614266c-d926-4847-8943-2375c7f70b87" />


## 예산에 따라서 관리할 수 있다

- Budgets 기능으로 예산을 설정하고, 임계값 초과 시 알림을 받을 수 있다.
- 이메일로 예산 보고서 포트폴리오(AWS Budgets 보고서)를 받을 수도 있다.

## 비용과 사용 현황을 확인한다

- 비용 및 사용 보고서는 하루 1회 CSV 파일로 S3에 저장
- `Amazon Athena`, `Redshift`, `QuickSight` 등과 연동하여 분석, 토계 및 시각화 가능

<img width="606" alt="image" src="https://github.com/user-attachments/assets/cba4e0dc-26f7-4e98-ae5c-44cd0a343a63" />


## 비용 관리 요령

- EC2, S3처럼 자유도와 비용을 비교하여 적절한 서비스 선택
- 사용하지 않는 리소스는 즉시 중단 또는 삭제
- 정기적으로 새로운 서비스와 요금 모델 확인
- EC2의 경우 인스턴스 유형과 옵션 선택이 비용에 큰 영향을 준다

# 리전과 가용 영역: 세계 각국에 존재하는 데이터 센터

- 리전은 AWS의 데이터 센터 단위로, 전 세계에 분산되어 있어 글로벌 서비스를 가능하게 한다.
- 각 리전은 여러 개의 가용 영역(AZ: Availability Zone)을 갖고 있으며, 이들 AZ는 서로 물리적으로 분리된 독립된 시설이다. 이를 통해 장애 발생 시 시스템 전체 중단을 방지할 수 있다.

## 리전과 가용 영역

- AWS는 전 세계 25개 지역(2021년 기준)에 리전을 운영하고 있으며, 서울 리전도 존재한다.
- `리전(Region)`: AWS 리소스를 생성할 때 선택하는 지역 단위.
- `가용 영역(AZ)`: 리전 내의 독립된 데이터 센터 그룹으로, 서로 다른 위치에 분산돼 있어 장애 격리가 가능하다.
- 시스템 안정성을 위해 여러 AZ에 걸쳐 인프라를 구성하는 것이 중요하다.

## 리전과 서비스

- 리전은 단순한 위치 개념을 넘어, 서비스 제공 여부에도 영향을 준다.
- 어떤 서비스는 특정 리전에서만 제공되기 때문에, 사용자는 해당 서비스를 위해 다른 리전을 선택해야 할 수 있다.
- 예: 서울 리전에 없는 서비스는 미국 동부 리전 등에서 사용 가능.
- 또한 리전마다 서비스 요금이 다를 수 있어, 비용을 고려해 외국 리전을 선택하기도 한다.
- 어떤 리전을 선택해도 AWS 콘솔에서는 한국어 UI를 통해 동일하게 관리할 수 있다
