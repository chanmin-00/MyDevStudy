# 데이터베이스와 RDB: 데이터를 관리하는 시스템

## 데이터베이스란

- 대부분의 소프트웨어와 시스템은 대규모 데이터를 처리하기 위해 데이터베이스를 사용한다.
- 블로그, SNS, 검색, 쇼핑, 의료 기록, 스마트폰 게임 등 거의 모든 서비스가 이를 사용한다.
- 데이터베이스는 구조적으로 정리된 데이터의 집합체이며, 구조화된 덕분에 원하는 데이터를 쉽게 검색하거나 추출할 수 있다.

## 데이터베이스와 DBMS

- 데이터베이스는 단순한 데이터의 모음일 뿐, 직접 데이터를 조작하는 기능은 없다.
- 실제 데이터를 저장, 검색, 삭제하는 역할은 `DBMS(Database Management System)`가 담당한다.
- DBMS는 스스로 판단하지 않으며, 사용자가 프로그래밍 언어를 통해 명령을 내려야 동작한다. 이때 사용하는 언어가 SQL이다.
    - SQL은 명령어와 문법이 정해진 언어이며, DBMS마다 문법 차이는 약간 있지만 대체로 유사하다.
    - SQL은 단독으로 사용되기보다 프로그램과 함께 조합되어 사용된다.
    - 즉, 특정 소프트웨어가 DB를 필요로 하기 때문에 함께 사용하는 경우가 많다.

## DBMS

- 일반적으로 데이터베이스와 DBMS를 함께 묶어 데이터베이스라고 부른다. 예를 들어, MySQL, PostgreSQL, Oracle Database 등은 정확히는 DBMS이다.
- DBMS는 크게 유료와 무료로 나뉜다.
    - 유료 DBMS: Oracle Database, SQL Server
    - 무료 DBMS: MySQL, PostgreSQL, MariaDB
- 기능 차이는 크지 않지만, 처리 속도, 안전성, 확장성 등에서 특화된 기능이 다를 수 있다.

## RDB와 비RDB

데이터베이스는 관계형(RDB)과 비관계형(비RDB, NoSQL)으로 나뉜다.

- RDB: 표 형태 구조, 정밀한 조작 가능, SQL 사용
    - 예: Amazon RDS
- 비RDB: 구조 단순, 빠른 구축과 속도, SQL 미사용
    - 예: DynamoDB, ElastiCache

# Amazon RDS란 : 주요 RDBMS 를 제공하는 데이터베이스 서비스

## Amazon RDS란?

- `Amazon RDS(Relational Database Service)`는 클라우드에 최적화된 6종의 관계형 데이터베이스(Aurora, PostgreSQL, MySQL, MariaDB, Oracle, SQL Server)를 제공하는 서비스다.
- VPC 상에 인스턴스 형태로 구축되며, EC2처럼 인스턴스 클래스를 선택해 사용할 수 있다.
- EC2와 달리 RDS는 매니지드 서비스로, 백업과 업데이트 등 관리 작업을 AWS가 자동으로 수행한다.
- AWS DMS를 통해 기존 데이터베이스를 RDS로 이전하거나 복제할 수도 있다.

## 인스턴스 클래스

- RDS는 EC2와 유사하게 인스턴스 클래스별로 선택하여 사용한다.
- 종류는 표준, 메모리 최적화, 버스트 성능 세 가지로 나뉘며, 각 클래스마다 micro ~ 16xlarge까지 크기를 제공한다.
    - 표준 (db.m5): 일반적인 용도
    - 메모리 최적화 (db.x1e, db.r5 등): 메모리 사용량이 많은 애플리케이션에 적합
    - 버스트 성능 (db.t3): CPU 사용량이 적지만 순간적으로 높은 성능이 필요한 경우 사용
- 현재는 모든 DB 인스턴스를 반드시 VPC 내부에 설치해야 한다.

## RDS 요금

- RDS 요금은 EC2와 비슷하지만 DBMS 종류에 따라 차이가 있다.
- 유료 DBMS의 경우 라이선스 비용이 포함되어 있다.
- 총 요금 구성은 다음과 같다:
    1. 스토리지 요금
        - 할당한 디스크 용량 기준으로 과금
    2. 데이터베이스 인스턴스 요금
        - 인스턴스 성능, AZ 구성 여부, DBMS 종류에 따라 시간당 요금이 달라진다
        - 다중 AZ로 구성 시 단일 AZ의 약 2배 요금 발생
    3. 백업 스토리지 요금
        - 스냅샷 용량이 운영 중인 스토리지 크기를 초과할 경우만 과금
    4. 통신료
        - 인터넷 통신 시 과금
        - 같은 VPC 내 EC2와 통신할 경우 무료

## RDS의 장점과 단점

장점

- 관리가 편하다 (백업, 패치 자동화)
- 손쉽게 데이터베이스를 생성하고 EC2와 연동 가능
- 데이터 이전이 쉬우며, 같은 VPC 내 통신은 무료

단점

- DBMS 종류와 버전이 제한된다
- AWS가 자동 업데이트를 수행해 원치 않는 타이밍에 적용될 수도 있다

# RDS 에서 사용할 수 있는 DBMS: 데이터베이스 엔진을 선택한다

## RDS 에서 사용할 수 있는 데이터베이스 엔진

RDS에서는 AWS가 만든 Amazon Aurora를 포함해 총 6종의 DBMS를 지원한다.

- 지원 엔진: Aurora, PostgreSQL, MySQL, MariaDB, Oracle Database, SQL Server
- 온프레미스 → AWS 이전이 쉽고, SQL Server, Oracle 같은 상용 DBMS도 포함된다.
    - 이 경우 라이선스 요금은 인스턴스 요금에 포함되므로 요금 체계가 단순하다.

## Amazon Aurora

- Amazon Aurora는 AWS가 만든 고성능 관계형 데이터베이스로, MySQL과 PostgreSQL과 호환 가능하다.
    - 호환성 덕분에 기존 MySQL/PostgreSQL 환경에서 SQL 문, 코드, 애플리케이션, 드라이버, 도구 등을 거의 수정 없이 이전할 수 있다.
    - AWS 전용으로 설계되어 일반 MySQL, PostgreSQL보다 속도가 빠르고 안정적이다.
    - 매니지드 서비스로 운영되며 보안과 관리 측면에서도 유리하다.

MySQL/PostgreSQL을 AWS에서 사용하는 3가지 방법은 다음과 같다:

1. EC2에 직접 설치
2. RDS에서 사용
3. Amazon Aurora 사용

- 이 중 Aurora는 성능이 높고 DBMS 변경도 수월해, 고성능이 필요할 경우 적합하다.
- 단, RDS는 특정 DBMS 버전을 지원하지 않을 수 있으므로, 이전 버전이나 특수 버전이 필요할 경우에는 EC2에 직접 설치하는 방식을 사용한다.

# RDS 사용 절차 : 데이터베이스를 사용하기까지의 절차

## RDS 조작

RDS 조작은 크게 데이터베이스 준비 작업과 사용 작업으로 나뉜다.

- 준비 작업은 관리 콘솔에서 인스턴스를 생성하고 설정하는 것을 말하며, 보안 패치나 업데이트는 AWS가 자동으로 처리한다.
- 사용 작업은 데이터 입력, 수정, 삭제 등으로, 데이터베이스 클라이언트나 애플리케이션을 통해 이루어진다.
    - 일반적으로 EC2에 설치된 소프트웨어와 RDS를 연동하여 사용한다.

## RDS 서비스의 기능

RDS는 데이터베이스 설정 항목이 다양하므로, 사용 전 주요 항목을 이해해 두는 것이 좋다.

### 데이터베이스 엔진 항목

| 항목 | 설명 |
| --- | --- |
| **데이터베이스 엔진** | MySQL, PostgreSQL, MariaDB, Aurora 등 DBMS 종류 선택 |
| **템플릿** | 프로덕션/개발 환경 선택, 예: 프로덕션은 다중 AZ 기본 적용 |
| **라이선스 모델** | GPL 등 다양한 라이선스 유형 중 선택 가능 |
| **버전** | 지원되는 DBMS 버전 중 선택 |

### 데이터베이스 인스턴스 항목

| 항목 | 설명 |
| --- | --- |
| **인스턴스 클래스** | EC2처럼 사양 선택 (성능에 따라 요금 달라짐) |
| **다중 AZ 배포** | 고가용성 구성을 위한 이중화 설정 |
| **스토리지 유형/할당** | 디스크 종류 및 용량 설정 |
| **자동 스케일링** | 스토리지 부족 시 자동 확장 여부 |
| **스케일링 임계값** | 자동 확장을 트리거할 임계값 |
| **클러스터 식별자** | 관리용 이름 (DB 이름 아님) |
| **마스터 사용자명/암호** | DB 관리자 계정과 비밀번호 설정 |

### 네트워크 항목

| 항목 | 설명 |
| --- | --- |
| **VPC** | RDS를 설치할 VPC 지정 |
| **서브넷 그룹** | EC2와 연동 시 동일한 서브넷 그룹 사용 권장 |
| **퍼블릭 액세스 가능 여부** | 외부에서 직접 접근 가능 여부 (보안상 주의) |
| **가용 영역** | 설치할 AZ 선택 (EC2와 동일 위치 권장) |
| **보안 그룹** | 포트 오픈 설정, 없으면 사전에 생성 필요 |

### 데이터베이스 환경 항목

| 항목 | 설명 |
| --- | --- |
| **데이터베이스명** | 실제 사용할 데이터베이스 이름 |
| **포트** | 사용하는 DBMS에 따라 지정 (예: MySQL 3306) |
| **파라미터 그룹/옵션 그룹** | 환경 설정 및 부가 기능 설정 (기본값 사용 가능) |
| **암호화** | 데이터 암호화 여부 |
| **백업** | 자동 백업 보존 기간 설정 |
| **모니터링** | 확장 모니터링 여부 (CloudWatch 이용, 유료) |
| **로그 내보내기** | CloudWatch Logs로 로그 출력 여부 |
| **유지 관리** | 자동 업데이트 시간대 설정 |
| **삭제 방지** | 실수로 인스턴스를 삭제하지 않도록 보호 여부 설정 |

## RDS의 사용 절차

- RDS를 사용하려면 관리 콘솔에서 인스턴스를 생성해야 하며, 이후 DB 클라이언트나 소프트웨어를 통해 데이터 조작이 가능하다.
- 일반적으로는 EC2에 설치된 소프트웨어와 RDS를 연동해서 사용하므로, RDS는 EC2와 같은 VPC와 가용 영역에 배치하는 것이 중요하다.
- 설계 단계에서 EC2, VPC, RDS 간의 연동 구성을 명확히 하고, 연결 오류를 방지하기 위해 미리 네트워크 구조를 확인해 두는 것이 좋다.

# 키 밸류 데이터베이스 : 키를 관리하는 데이터베이스 서비스

## 키 밸류 스토어 데이터베이스란

- 키-밸류 스토어(KVS)는 데이터 형식에 상관없이, 특정 `키`를 기준으로 데이터를 `쌍(pair)`으로 저장하는 방식의 데이터베이스이다.
- NoSQL 데이터베이스의 대표적인 형태이며, 관계형 데이터베이스보다 역사적으로 오래된 방식이다.
- 여기서 `키`는 데이터를 빠르게 찾기 위한 라벨(label) 역할을 한다.
- 형식에 구애받지 않고 데이터를 자유롭게 저장할 수 있는 반면, 구조화되지 않아서 정교한 검색은 어렵고, 대신 데이터 접근 속도는 빠르다.

- 아래와 같이 ID와 유형으로 구분된 데이터가 저장된다.
- 데이터 형식이 제각각이고, 키로만 접근이 가능하다.

| ID | 유형 | 데이터 내용 |
| --- | --- | --- |
| 1 | book01 | 로버트 A 하인라인, 「여름으로 가는 문」 |
| 2 | music01 | 「알프스 교향곡」, 지휘자 00, A 오케스트라 |
| 3 | movie01 | 미나리 |
| 4 | movie01 | 기생충 |

### AWS에서 제공하는 KVS

AWS에서는 두 가지 형태의 키-밸류 스토어가 제공된다.

1. `Amazon DynamoDB`: 스토리지(디스크) 기반 저장
2. `Amazon ElastiCache`: 메모리 기반 저장

## DynamoDB란

- `Amazon DynamoDB는 키-밸류 스토어 데이터베이스`로, 관계형 데이터베이스에 적합하지 않은 범용적이고 유연한 데이터를 저장할 때 사용한다.

### 관계형 데이터베이스와의 비교

| 항목 | 관계형 DB | 키-밸류 스토어 (DynamoDB) |
| --- | --- | --- |
| 구조 | 표 형식, 테이블 간 관계 있음 | 정해진 형식 없음, 관계 없음 |
| 장점 | 중복 없음, 스토리지 절약 | 데이터 입력 유연, 속도 빠름 |
| 단점 | 느린 저장 속도 | SQL 사용 불가, 고급 검색 어려움 |

### 특징

- 형식 자유롭고 빠른 응답 속도를 제공한다.
- SQL을 사용할 수 없고, 복잡한 검색에는 제약이 있다.
- VPC 없이도 사용 가능하기 때문에 VPC를 사용하지 않는 Lambda와 같은 서버리스 환경에 적합하다.
- 대규모 데이터 처리에 최적화
    - ACID 트랜잭션 지원
    - 데이터 암호화, 접근 제어 기능 제공
    - 글로벌 테이블을 생성 가능하며, 여러 리전에 데이터가 자동으로 **분산 및 동기화**된다.

## Amazon ElastiCache란

- Amazon ElastiCache는 `인-메모리 데이터베이스(In-memory database)`이다.
- 인-메모리 데이터베이스는 외부 저장장치를 매번 접근하지 않고, 자주 쓰이는 데이터를 메모리에 임시 보관(캐시)하여 처리 속도를 높이는 방식이다.

### DynamoDB의 비교

- DynamoDB는 디스크와 같은 스토리지 기반의 데이터베이스로, 데이터를 영구적으로 저장할 수 있다. 속도도 빠른 편이지만, ElastiCache보다는 느리다. 주로 일반적인 데이터 저장 용도로 사용된다.
- 반면, ElastiCache는 메모리 기반의 인-메모리 데이터베이스로, 데이터가 메모리에 저장되기 때문에 처리 속도가 DynamoDB보다 훨씬 빠르다.
- 그러나 인스턴스를 재시작하면 메모리에 저장된 데이터는 소실되므로, 영구 저장보다는 빠른 접근이 필요한 캐시 용도에 적합하다.

즉, DynamoDB는 안정적인 저장이 필요한 경우, ElastiCache는 빠른 읽기/쓰기가 필요한 경우에 각각 사용하는 것이 효과적이다.

### ElastiCache의 구성

- Redis용과 Memcached용 두 가지가 제공된다.
    - Redis와 Memcached는 대표적인 `인-메모리 키-밸류 스토어 DBMS`
- **기존 애플리케이션을 변경하지 않아도 호환 가능하다.**
    - Redis나 Memcached를 사용 중이라면 ElastiCache로 쉽게 전환 가능

# 그 외의 데이터베이스 : 다양한 데이터베이스 서비스를 제공한다

## 그 외의 데이터베이스

시스템이 대형화되고 복잡해짐에 따라, 기존의 관계형 데이터베이스나 키-밸류 스토어만으로는 처리하기 어려운 새로운 데이터 유형들이 등장했다.

### AWS에서 제공하는 주요 특수 데이터베이스

- `DocumentDB`: 문서 기반 데이터베이스 (비정형 JSON 문서 저장에 적합)
- `Neptune`: 그래프 데이터베이스 (노드/간선 관계 중심 데이터에 적합)
- `Timestream`: 시계열 데이터베이스 (시간 순으로 변화하는 센서/로그 데이터 등)
- `Quantum Ledger Database (QLDB)`: 장부형 데이터베이스 (변경 이력 추적, 회계/감사 용도)

## Amazon DocumentDB(MongoDB 호환 ) 란

- `Amazon DocumentDB`는 MongoDB와 호환되는 문서 기반 데이터베이스 서비스이다.
    
    > MongoDB는 오픈 소스 NoSQL 데이터베이스로, JSON 데이터를 BSON 형식으로 저장하며, 빅데이터와 분산 처리에 적합한 구조를 가지고 있다.
    > 
- DocumentDB는 MongoDB가 대규모 데이터를 안정적으로 입출력할 수 있도록 AWS가 설계한 서비스이며, 기존 MongoDB 드라이버나 도구를 그대로 사용할 수 있다는 점이 큰 장점이다.
- 또한, AWS Database Migration Service를 사용하면, Amazon EC2에서 운영 중인 MongoDB 데이터를 다운타임 없이 DocumentDB로 마이그레이션할 수 있다.

## Amazon Neptune이란

- Amazon Neptune은 그래프 데이터베이스로, 노드 간의 관계나 연결 구조를 저장하는 데 특화된 서비스이다.
- Property Graph와 RDF 모델을 지원하며, Gremlin과 SPARQL 같은 쿼리 언어를 사용한다.
- 데이터는 HTTPS로 암호화되어 안전하게 읽고 쓸 수 있고, 자동 관리 기능도 제공된다.
- 추천 시스템, 소셜 네트워크, 지식 그래프 등 복잡한 관계 분석이 필요한 분야에 활용된다.

## Amazon Timestream이란

- 시계열 데이터베이스로, 시간에 따라 변화하는 IoT 데이터를 효율적으로 저장하고 분석하는 데 적합하다.
- 시간 기반 쿼리에 최적화되어 있으며, 평활법,보간 등 분석 함수를 지원한다.
- 자동 스케일링과 계층 분리 처리로 성능 유지 및 관리 비용 절감한다.

## Amazon QLDB이란

- 장부(원장) 데이터베이스로, 데이터 변경 이력 추적과 검증에 특화되어 있다.
- 변경 불가능한 저널 구조와 SHA-256 해시로 데이터 무결성을 보장한다.
- SQL 유사 API 제공, 회계나 감사 기록 관리에 적합하다.
